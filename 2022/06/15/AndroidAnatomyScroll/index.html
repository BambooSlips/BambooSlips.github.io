<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>Android Anatomy</title><meta name="description" content="May it be an evening star shines down upon you."><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q || []).push(arguments)},i[r].l=1 * new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'G-G8T1Z4FBY6', 'www.googletagmanager.com');
ga('send', 'pageview');</script><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/oracle.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="
Android三窥首先，分别从Android的层次结构、服务模型和源代码这三个不同的角度一窥Android系统。
Android Layer Cake下图是Android系统的层次模型，其左半部分可以看作一个如同Ubuntu的一般的Linux发行版本，而右半部分则是Android系统的特定组成部分。

该模型将Android分为四个主要层次，每一层都基于其下一层，从下至上依次是：硬件层、Linux内核层、系统库层以及应用和系统服务层。目前，大多数的Android开发者主要的工作集中于上图的“Android Applications”区域，他们将时间用于学习和利用Android系统提供的环境。而本文的主要内容是关于如何自定义Android系统本身以使其适用于新的硬件。
硬件层硬件层即物理设备，它处于当前模型.."><meta name="generator" content="Hexo 7.0.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="BambooSlips' blog" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">BambooSlips's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Android Anatomy</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Android%E4%B8%89%E7%AA%A5"><span class="toc-text">Android三窥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Android-Layer-Cake"><span class="toc-text">Android Layer Cake</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A1%AC%E4%BB%B6%E5%B1%82"><span class="toc-text">硬件层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Linux%E5%86%85%E6%A0%B8%E5%B1%82"><span class="toc-text">Linux内核层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%BA%93%E5%B1%82"><span class="toc-text">系统库层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%92%8C%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E5%B1%82"><span class="toc-text">应用和系统服务层</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Android-Service-Model"><span class="toc-text">The Android Service Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Source"><span class="toc-text">The Source</span></a></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/Android"><i class="tag post-item-tag">Android</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">Android Anatomy</h1><time class="has-text-grey" datetime="2022-06-15T03:16:10.000Z">2022-06-15</time><article class="mt-2 post-content"><p><img src="/images/android_anatomy.png" alt="Android Anatomy"></p>
<h2 id="Android三窥"><a href="#Android三窥" class="headerlink" title="Android三窥"></a>Android三窥</h2><p>首先，分别从Android的层次结构、服务模型和源代码这三个不同的角度一窥Android系统。</p>
<h3 id="Android-Layer-Cake"><a href="#Android-Layer-Cake" class="headerlink" title="Android Layer Cake"></a>Android Layer Cake</h3><p>下图是Android系统的层次模型，其左半部分可以看作一个如同Ubuntu的一般的Linux发行版本，而右半部分则是Android系统的特定组成部分。</p>
<p><img src="/images/AndroidLayerCake.jpg" alt="Android Layer Cake"></p>
<p>该模型将Android分为四个主要层次，每一层都基于其下一层，从下至上依次是：硬件层、Linux内核层、系统库层以及应用和系统服务层。目前，大多数的Android开发者主要的工作集中于上图的“Android Applications”区域，他们将时间用于学习和利用Android系统提供的环境。而本文的主要内容是关于如何自定义Android系统本身以使其适用于新的硬件。</p>
<h4 id="硬件层"><a href="#硬件层" class="headerlink" title="硬件层"></a>硬件层</h4><p>硬件层即物理设备，它处于当前模型的最底层。</p>
<h4 id="Linux内核层"><a href="#Linux内核层" class="headerlink" title="Linux内核层"></a>Linux内核层</h4><p>内核是创造进程及所有应用运行的内存环境的软件。Android的内核是一种Linux内核的变体，它是Android系统的首要移植层。将Android移植到一个新设备上的过程包括将一个Android的Linux内核变体运行在目标设备上，然后将Android的其它部分放置其上。另外，在Android中，Java源代码并不是被编译为JVM的指令，而是被编译为Dalvik和ART的指令。Android VM的目标是使得应用在Android设备间可移植，而不是和JVM一样，使得它们在多平台和系统间可移植。</p>
<h4 id="系统库层"><a href="#系统库层" class="headerlink" title="系统库层"></a>系统库层</h4><p>系统库即软件库，它通常是由第三方提供的不透明的二进制文件，用于实现用于多个应用的服务。一些会被多个应用用到的通用功能，如密码系统、影音和web浏览器较为复杂，将它们实现为可被多个应用使用的库是很合情合理的。<br>在Android的系统库的众多组成中，Bionic尤为值得特殊注意。可以说，Bionic相当于Android的标准C库。大部分应用并不直接请求内核的服务，而是使用C标准库请求内核服务。C标准库接口一开始是ANSI(American National Standards Institute) C 标准的一部分，后来也逐渐为ISO所接受。而现在广认可的POSIX(Portable Operating System Interface of UNIX) C 标准库则是一个对其有所增加的父集。<br>随着Android对于节简的追求，Bionic已经被无情地精简了很多。较之其BSD(Berkly Software Distribution)的祖先，它已经小了很多，以至于它已不能满足ANSI标准，更不用说POSIX标准了。所以，在其它平台上运行地很好的应用，可能因为Bionic不支持其所需的函数而根本不能在Android上面运行。<br>另外，Bionic根源于BSD。不同于大部分操作系统基于一个使用某一版本的GNU C标注库(glibc)，Android的Bionic源于BSD UNIX的libc。这样做的原因很多，其中一个原因就是libc得到了BSD的许可，这样它便不会如同glibc一样受到加于其上的LGPL(GNU Lesser General Public License)的约束。</p>
<h4 id="应用和系统服务层"><a href="#应用和系统服务层" class="headerlink" title="应用和系统服务层"></a>应用和系统服务层</h4><p>应用使用由更底层提供的环境向用户提供服务。一些特殊的，持续运行的应用被称为系统服务，有时候也被称为守护进程（daemons)，它们执行周期性的任务，管理系统状态。</p>
<h3 id="The-Android-Service-Model"><a href="#The-Android-Service-Model" class="headerlink" title="The Android Service Model"></a>The Android Service Model</h3><h3 id="The-Source"><a href="#The-Source" class="headerlink" title="The Source"></a>The Source</h3></article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2022/08/23/CamX&amp;ChiScroll/" title="CamX &amp; Chi"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: CamX &amp; Chi</span></a><a class="button is-default" href="/2021/05/27/TestScroll/" title="软件测试 Software Testing"><span class="has-text-weight-semibold">Next: 软件测试 Software Testing</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="BambooSlips/BambooSlips.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com//"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/BambooSlips"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com//"><i class="iconfont icon-ins"></i></a><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> BambooSlips 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo</p><!-- p.is-flex.is-justify-content-center--><!--   a(title="Hexo theme author" href='//github.com/haojen') Theme by Haojen&nbsp;--><!-- div(style="margin-top: 2px")--><!--   a(title="github-button" class="github-button" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true")--></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>